from src.etl.extract import *

@pytest.fixture
def sample_soup():
    html = '''
        <html>
            <body>
                <div class="ds-p-4 hover:ds-bg-ui-fill-translucent ds-border-none ds-border-t ds-border-line"><div class="ds-flex"><div class="ds-text-compact-xs ds-font-bold ds-w-24">Fri, 31 Mar</div><div class="ds-grow ds-px-4 ds-border-r ds-border-line-default-translucent"><a href="/series/indian-premier-league-2023-1345038/gujarat-titans-vs-chennai-super-kings-1st-match-1359475/full-scorecard" class="ds-no-tap-higlight"><div class="ds-text-compact-xxs"><div class=""><div class="ds-flex ds-justify-between ds-items-center"><div class="ds-truncate"><span class=""><span class="ds-text-tight-xs ds-font-bold ds-uppercase ds-leading-5">RESULT</span></span><div class="ds-text-tight-xs ds-truncate ds-text-typo-mid3">1st Match (N), Ahmedabad, March 31, 2023<!-- -->, <span title="IPL 2023" class="ds-cursor-pointer ds-inline-flex ds-items-start ds-leading-none !ds-inline"><span class="ds-text-tight-xs ds-text-typo ds-underline ds-decoration-ui-stroke hover:ds-text-typo-primary hover:ds-decoration-ui-stroke-primary ds-block !ds-inline">Indian Premier League</span></span></div></div><div class="ds-leading-[0]"></div></div><div class=""><div class="ds-flex ds-flex-col ds-mt-2 ds-mb-2"><div class="ci-team-score ds-flex ds-justify-between ds-items-center ds-text-typo ds-opacity-50 ds-my-1"><div class="ds-flex ds-items-center ds-min-w-0 ds-mr-1" title="Chennai Super Kings"><img width="20" height="20" alt="Chennai Super Kings Flag" style="width:20px;height:20px" class="ds-mr-2" src="https://img1.hscicdn.com/image/upload/f_auto,t_ds_square_w_80/lsci/db/PICTURES/CMS/313400/313421.logo.png"><p class="ds-text-tight-m ds-font-bold ds-capitalize ds-truncate">Chennai Super Kings</p></div><div class="ds-text-compact-s ds-text-typo ds-text-right ds-whitespace-nowrap"><span class="ds-text-compact-xs ds-mr-0.5"></span><strong class="">178/7</strong></div></div><div class="ci-team-score ds-flex ds-justify-between ds-items-center ds-text-typo ds-my-1"><div class="ds-flex ds-items-center ds-min-w-0 ds-mr-1" title="Gujarat Titans"><img width="20" height="20" alt="Gujarat Titans Flag" style="width:20px;height:20px" class="ds-mr-2" src="https://img1.hscicdn.com/image/upload/f_auto,t_ds_square_w_80/lsci/db/PICTURES/CMS/334700/334707.png"><p class="ds-text-tight-m ds-font-bold ds-capitalize ds-truncate">Gujarat Titans</p></div><div class="ds-text-compact-s ds-text-typo ds-text-right ds-whitespace-nowrap"><span class="ds-text-compact-xs ds-mr-0.5">(19.2/20 ov, T:179) </span><strong class="">182/5</strong></div></div></div></div><p class="ds-text-tight-s ds-font-regular ds-line-clamp-2 ds-text-typo" title="Titans won by 5 wickets (with 4 balls remaining)"><span>Titans won by 5 wickets (with 4 balls remaining)</span></p></div></div></a><div><div class="ds-px-3 ds-py-2 ds-flex ds-items-center ds-pl-0 ds-pb-0"><span class="ds-inline-flex ds-items-center"><img width="44" height="12" alt="Bet 365 Logo" style="width:44px;height:12px" src="https://wassets.hscicdn.com/static/images/bet365-logo.svg"><span class="ds-text-tight-s ds-font-regular ds-ml-2">In-play betting with bet365.</span></span><span class="ds-ml-4"><a href="https://www.bet365.com/olp/open-account?affiliate=365_728177" target="_blank" rel="noopener noreferrer" class="ds-inline-flex ds-items-center ds-text-typo-primary"><span class="ds-text-tight-s ds-font-bold">Bet Now</span>&nbsp;<i style="font-size:16px" class="icon-launch-outlined ds-text-icon-primary"></i></a></span></div></div></div><div class="ds-px-4 ds-self-center ds-w-28"><div><a href="/series/indian-premier-league-2023-1345038/gujarat-titans-vs-chennai-super-kings-1st-match-1359475/match-report" class="ds-inline-flex ds-items-start ds-leading-none"><span class="ds-text-compact-xs ds-text-typo hover:ds-underline hover:ds-decoration-ui-stroke ds-block">Report</span></a></div><div><a href="/series/indian-premier-league-2023-1345038/gujarat-titans-vs-chennai-super-kings-1st-match-1359475/match-photo" class="ds-inline-flex ds-items-start ds-leading-none"><span class="ds-text-compact-xs ds-text-typo hover:ds-underline hover:ds-decoration-ui-stroke ds-block">Photos</span></a></div><div><a href="/series/indian-premier-league-2023-1345038/gujarat-titans-vs-chennai-super-kings-1st-match-1359475/match-videos" class="ds-inline-flex ds-items-start ds-leading-none"><span class="ds-text-compact-xs ds-text-typo hover:ds-underline hover:ds-decoration-ui-stroke ds-block">Videos</span></a></div></div></div></div>
                    <div class="ds-flex"><div class="ds-text-compact-xs ds-font-bold ds-w-24">Fri, 31 Mar</div><div class="ds-grow ds-px-4 ds-border-r ds-border-line-default-translucent"><a href="/series/indian-premier-league-2023-1345038/gujarat-titans-vs-chennai-super-kings-1st-match-1359475/full-scorecard" class="ds-no-tap-higlight"><div class="ds-text-compact-xxs"><div class=""><div class="ds-flex ds-justify-between ds-items-center"><div class="ds-truncate"><span class=""><span class="ds-text-tight-xs ds-font-bold ds-uppercase ds-leading-5">RESULT</span></span><div class="ds-text-tight-xs ds-truncate ds-text-typo-mid3">1st Match (N), Ahmedabad, March 31, 2023<!-- -->, <span title="IPL 2023" class="ds-cursor-pointer ds-inline-flex ds-items-start ds-leading-none !ds-inline"><span class="ds-text-tight-xs ds-text-typo ds-underline ds-decoration-ui-stroke hover:ds-text-typo-primary hover:ds-decoration-ui-stroke-primary ds-block !ds-inline">Indian Premier League</span></span></div></div><div class="ds-leading-[0]"></div></div><div class=""><div class="ds-flex ds-flex-col ds-mt-2 ds-mb-2"><div class="ci-team-score ds-flex ds-justify-between ds-items-center ds-text-typo ds-opacity-50 ds-my-1"><div class="ds-flex ds-items-center ds-min-w-0 ds-mr-1" title="Chennai Super Kings"><img width="20" height="20" alt="Chennai Super Kings Flag" style="width:20px;height:20px" class="ds-mr-2" src="https://img1.hscicdn.com/image/upload/f_auto,t_ds_square_w_80/lsci/db/PICTURES/CMS/313400/313421.logo.png"><p class="ds-text-tight-m ds-font-bold ds-capitalize ds-truncate">Chennai Super Kings</p></div><div class="ds-text-compact-s ds-text-typo ds-text-right ds-whitespace-nowrap"><span class="ds-text-compact-xs ds-mr-0.5"></span><strong class="">178/7</strong></div></div><div class="ci-team-score ds-flex ds-justify-between ds-items-center ds-text-typo ds-my-1"><div class="ds-flex ds-items-center ds-min-w-0 ds-mr-1" title="Gujarat Titans"><img width="20" height="20" alt="Gujarat Titans Flag" style="width:20px;height:20px" class="ds-mr-2" src="https://img1.hscicdn.com/image/upload/f_auto,t_ds_square_w_80/lsci/db/PICTURES/CMS/334700/334707.png"><p class="ds-text-tight-m ds-font-bold ds-capitalize ds-truncate">Gujarat Titans</p></div><div class="ds-text-compact-s ds-text-typo ds-text-right ds-whitespace-nowrap"><span class="ds-text-compact-xs ds-mr-0.5">(19.2/20 ov, T:179) </span><strong class="">182/5</strong></div></div></div></div><p class="ds-text-tight-s ds-font-regular ds-line-clamp-2 ds-text-typo" title="Titans won by 5 wickets (with 4 balls remaining)"><span>Titans won by 5 wickets (with 4 balls remaining)</span></p></div></div></a><div><div class="ds-px-3 ds-py-2 ds-flex ds-items-center ds-pl-0 ds-pb-0"><span class="ds-inline-flex ds-items-center"><img width="44" height="12" alt="Bet 365 Logo" style="width:44px;height:12px" src="https://wassets.hscicdn.com/static/images/bet365-logo.svg"><span class="ds-text-tight-s ds-font-regular ds-ml-2">In-play betting with bet365.</span></span><span class="ds-ml-4"><a href="https://www.bet365.com/olp/open-account?affiliate=365_728177" target="_blank" rel="noopener noreferrer" class="ds-inline-flex ds-items-center ds-text-typo-primary"><span class="ds-text-tight-s ds-font-bold">Bet Now</span>&nbsp;<i style="font-size:16px" class="icon-launch-outlined ds-text-icon-primary"></i></a></span></div></div></div><div class="ds-px-4 ds-self-center ds-w-28"><div><a href="/series/indian-premier-league-2023-1345038/gujarat-titans-vs-chennai-super-kings-1st-match-1359475/match-report" class="ds-inline-flex ds-items-start ds-leading-none"><span class="ds-text-compact-xs ds-text-typo hover:ds-underline hover:ds-decoration-ui-stroke ds-block">Report</span></a></div><div><a href="/series/indian-premier-league-2023-1345038/gujarat-titans-vs-chennai-super-kings-1st-match-1359475/match-photo" class="ds-inline-flex ds-items-start ds-leading-none"><span class="ds-text-compact-xs ds-text-typo hover:ds-underline hover:ds-decoration-ui-stroke ds-block">Photos</span></a></div><div><a href="/series/indian-premier-league-2023-1345038/gujarat-titans-vs-chennai-super-kings-1st-match-1359475/match-videos" class="ds-inline-flex ds-items-start ds-leading-none"><span class="ds-text-compact-xs ds-text-typo hover:ds-underline hover:ds-decoration-ui-stroke ds-block">Videos</span></a></div></div></div>
                        <div class="ds-grow ds-px-4 ds-border-r ds-border-line-default-translucent"><a href="/series/indian-premier-league-2023-1345038/gujarat-titans-vs-chennai-super-kings-1st-match-1359475/full-scorecard" class="ds-no-tap-higlight"><div class="ds-text-compact-xxs"><div class=""><div class="ds-flex ds-justify-between ds-items-center"><div class="ds-truncate"><span class=""><span class="ds-text-tight-xs ds-font-bold ds-uppercase ds-leading-5">RESULT</span></span><div class="ds-text-tight-xs ds-truncate ds-text-typo-mid3">1st Match (N), Ahmedabad, March 31, 2023<!-- -->, <span title="IPL 2023" class="ds-cursor-pointer ds-inline-flex ds-items-start ds-leading-none !ds-inline"><span class="ds-text-tight-xs ds-text-typo ds-underline ds-decoration-ui-stroke hover:ds-text-typo-primary hover:ds-decoration-ui-stroke-primary ds-block !ds-inline">Indian Premier League</span></span></div></div><div class="ds-leading-[0]"></div></div><div class=""><div class="ds-flex ds-flex-col ds-mt-2 ds-mb-2"><div class="ci-team-score ds-flex ds-justify-between ds-items-center ds-text-typo ds-opacity-50 ds-my-1"><div class="ds-flex ds-items-center ds-min-w-0 ds-mr-1" title="Chennai Super Kings"><img width="20" height="20" alt="Chennai Super Kings Flag" style="width:20px;height:20px" class="ds-mr-2" src="https://img1.hscicdn.com/image/upload/f_auto,t_ds_square_w_80/lsci/db/PICTURES/CMS/313400/313421.logo.png"><p class="ds-text-tight-m ds-font-bold ds-capitalize ds-truncate">Chennai Super Kings</p></div><div class="ds-text-compact-s ds-text-typo ds-text-right ds-whitespace-nowrap"><span class="ds-text-compact-xs ds-mr-0.5"></span><strong class="">178/7</strong></div></div><div class="ci-team-score ds-flex ds-justify-between ds-items-center ds-text-typo ds-my-1"><div class="ds-flex ds-items-center ds-min-w-0 ds-mr-1" title="Gujarat Titans"><img width="20" height="20" alt="Gujarat Titans Flag" style="width:20px;height:20px" class="ds-mr-2" src="https://img1.hscicdn.com/image/upload/f_auto,t_ds_square_w_80/lsci/db/PICTURES/CMS/334700/334707.png"><p class="ds-text-tight-m ds-font-bold ds-capitalize ds-truncate">Gujarat Titans</p></div><div class="ds-text-compact-s ds-text-typo ds-text-right ds-whitespace-nowrap"><span class="ds-text-compact-xs ds-mr-0.5">(19.2/20 ov, T:179) </span><strong class="">182/5</strong></div></div></div></div><p class="ds-text-tight-s ds-font-regular ds-line-clamp-2 ds-text-typo" title="Titans won by 5 wickets (with 4 balls remaining)"><span>Titans won by 5 wickets (with 4 balls remaining)</span></p></div></div></a><div><div class="ds-px-3 ds-py-2 ds-flex ds-items-center ds-pl-0 ds-pb-0"><span class="ds-inline-flex ds-items-center"><img width="44" height="12" alt="Bet 365 Logo" style="width:44px;height:12px" src="https://wassets.hscicdn.com/static/images/bet365-logo.svg"><span class="ds-text-tight-s ds-font-regular ds-ml-2">In-play betting with bet365.</span></span><span class="ds-ml-4"><a href="https://www.bet365.com/olp/open-account?affiliate=365_728177" target="_blank" rel="noopener noreferrer" class="ds-inline-flex ds-items-center ds-text-typo-primary"><span class="ds-text-tight-s ds-font-bold">Bet Now</span>&nbsp;<i style="font-size:16px" class="icon-launch-outlined ds-text-icon-primary"></i></a></span></div></div></div>
                            <a href="/series/indian-premier-league-2023-1345038/gujarat-titans-vs-chennai-super-kings-1st-match-1359475/full-scorecard" class="ds-no-tap-higlight"><div class="ds-text-compact-xxs"><div class=""><div class="ds-flex ds-justify-between ds-items-center"><div class="ds-truncate"><span class=""><span class="ds-text-tight-xs ds-font-bold ds-uppercase ds-leading-5">RESULT</span></span><div class="ds-text-tight-xs ds-truncate ds-text-typo-mid3">1st Match (N), Ahmedabad, March 31, 2023<!-- -->, <span title="IPL 2023" class="ds-cursor-pointer ds-inline-flex ds-items-start ds-leading-none !ds-inline"><span class="ds-text-tight-xs ds-text-typo ds-underline ds-decoration-ui-stroke hover:ds-text-typo-primary hover:ds-decoration-ui-stroke-primary ds-block !ds-inline">Indian Premier League</span></span></div></div><div class="ds-leading-[0]"></div></div><div class=""><div class="ds-flex ds-flex-col ds-mt-2 ds-mb-2"><div class="ci-team-score ds-flex ds-justify-between ds-items-center ds-text-typo ds-opacity-50 ds-my-1"><div class="ds-flex ds-items-center ds-min-w-0 ds-mr-1" title="Chennai Super Kings"><img width="20" height="20" alt="Chennai Super Kings Flag" style="width:20px;height:20px" class="ds-mr-2" src="https://img1.hscicdn.com/image/upload/f_auto,t_ds_square_w_80/lsci/db/PICTURES/CMS/313400/313421.logo.png"><p class="ds-text-tight-m ds-font-bold ds-capitalize ds-truncate">Chennai Super Kings</p></div><div class="ds-text-compact-s ds-text-typo ds-text-right ds-whitespace-nowrap"><span class="ds-text-compact-xs ds-mr-0.5"></span><strong class="">178/7</strong></div></div><div class="ci-team-score ds-flex ds-justify-between ds-items-center ds-text-typo ds-my-1"><div class="ds-flex ds-items-center ds-min-w-0 ds-mr-1" title="Gujarat Titans"><img width="20" height="20" alt="Gujarat Titans Flag" style="width:20px;height:20px" class="ds-mr-2" src="https://img1.hscicdn.com/image/upload/f_auto,t_ds_square_w_80/lsci/db/PICTURES/CMS/334700/334707.png"><p class="ds-text-tight-m ds-font-bold ds-capitalize ds-truncate">Gujarat Titans</p></div><div class="ds-text-compact-s ds-text-typo ds-text-right ds-whitespace-nowrap"><span class="ds-text-compact-xs ds-mr-0.5">(19.2/20 ov, T:179) </span><strong class="">182/5</strong></div></div></div></div><p class="ds-text-tight-s ds-font-regular ds-line-clamp-2 ds-text-typo" title="Titans won by 5 wickets (with 4 balls remaining)"><span>Titans won by 5 wickets (with 4 balls remaining)</span></p></div></div></a>
                        </div>
                    </div>
                </div>  
            </body>
        </html>
    '''
    return BeautifulSoup(html, 'lxml')

def test_get_card_returns_list(sample_soup):
    # Test that get_card() returns a list
    cards = get_card(sample_soup)
    assert isinstance(cards, list)

def test_get_each_card_prints_text(sample_soup, capsys):
    # Test that get_each_card() prints text for each card
    cards = get_card(sample_soup)
    get_each_card(cards)
    captured = capsys.readouterr()
    assert "Card 1\n" in captured.out
    assert "Card 2\n" in captured.out
    assert "Card 3\n" in captured.out



